<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
<!-- seo include -->
<meta name="description" content="" />
<link rel="canonical" href="http://localhost:4000/categories/InfoPath%202007/" />
<meta property="article:published_time" content="" />
<script type="application/ld+json">
    {
        "@type":"Site",
        "url":"http://localhost:4000/categories/InfoPath%202007/",
        "headline":"Category: InfoPath 2007",
        "dateModified":"",
        "datePublished":"",
        "author":{
            "name":"David McWee",
            "@type":"Person",
            "url":"http://localhost:4000"
        },
        
        "image":"http://localhost:4000/assets/images/me.jpg",
        
        "mainEntityOfPage":{
            "@type":"WebPage",
            "@id":"http://localhost:4000",
            "url":"http://localhost:4000/categories/InfoPath%202007/"
        },
        "description":"",
        "@context":"https://schema.org"
    }
</script>

<!-- facebook seo -->
<meta property="og:title" content="Category: InfoPath 2007" />
<meta property="og:locale" content="en_US" />
<meta property="og:description" content="" />
<meta property="og:url" content="http://localhost:4000/categories/InfoPath%202007/" />
<meta property="og:site_name" content="David McWee" />
<meta property="og:type" content="article" />
<!-- end facebook seo -->

<!-- twitter seo -->
<meta name="twitter:site" content="@" />
<meta name="twitter:title" content="Category: InfoPath 2007" />
<meta name="twitter:description" content="" />


<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="http://localhost:4000/assets/images/me.jpg" />


<meta name="twitter:image:alt" content="David McWee's Site Image" />

<!-- end twitter seo -->

<!-- end seo include -->

<!-- startgoogle analytics --><!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-K5M43KBSNX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-K5M43KBSNX');
</script><!-- end google analytics-->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <!--<link rel="stylesheet" href="/assets/css/blog.css">-->
    <link rel="stylesheet" href="/assets/css/davidmcwee.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="David McWee" />
    <title>David McWee - Category: InfoPath 2007</title>
    
</head><body><div class="container">
    <header class="blog-header py-3 px-3">
        <div class="row flex-nowrap justify-content-between align-items-center">
            <div class="col-4 pt-1">
                <a class="link-secondary" href="/tenant-tracker">Tenant Tracker</a>
            </div>
            <div class="col-4 text-center">
                <a class="blog-header-logo" href="/">David McWee</a>
            </div>
            <div class="col-4 d-flex justify-content-end align-items-center">
                <a class="link-secondary" href="/about">About</a>
            </div>
        </div>
    </header>
    <div class="nav-scroller py-1 px-3 mb-2 nav-secondary">
        <nav class="nav d-flex justify-content-between">
            
            <a class="p-2 link-secondary" href="/categories/identity">Identity</a>
            
            <a class="p-2 link-secondary" href="/categories/security">Security</a>
            
            <a class="p-2 link-secondary" href="/categories/mde">Defender for Endpoint</a>
            
            <a class="p-2 link-secondary" href="/categories/mdi">Defender for Identity</a>
            
            <a class="p-2 link-secondary" href="/categories/mdo">Defender for Office</a>
            
        </nav>
    </div>
</div><main class="container">
      <article class="post">

  <header class="post-header">
    <h1 class="post-title">Category: InfoPath 2007</h1>
  </header>

  <div class="post-content">
    
<article class="blog-post my-3">
    <h3>Custom Save Button for Web Enabled Form</h3>
    <p class="by-line">
        <span class="blog-date">Thu, May 14, 09</span>
        
        | <a href="/categories/InfoPath 2007">InfoPath 2007</a>
        
    </p>
    <p><p>I recently found the need to submit and save Infopath 2007 browser enabled form data. The submit is very straight forward when using browser enabled forms, but the ability to save the form is not so straight forward or so you might think. After thinking for a little while on how to work around the save capability I found a very simple process to allow users to Submit and Save InfoPath Browser enabled forms back to the SharePoint Library without any custom code.</p>

<p>Designing the Form</p>

<ul>
  <li>Begin by creating an InfoPath 2007 form with a button and some text box control(s).<a href="/assets/images/2009/05/clip_image0015b35d.png"><img src="/assets/images/2009/05/clip_image0015b35d.png" alt="clip_image001" title="clip\_image001" /></a></li>
  <li>Add an additional Data Source called submitFormName<a href="/assets/images/2009/05/clip_image0025b35d.png"><img src="/assets/images/2009/05/clip_image0025b35d.png" alt="clip_image002" title="clip\_image002" /></a></li>
</ul>

<p>Add a Data Connection</p>

<p>Create the Data Source Connection that will allow the form to be submitted to the SharePoint site using the following steps.</p>

<p> </p>

<ul>
  <li>Click on the Manage Data Connections… and then click the Add button<a href="/assets/images/2009/05/clip_image0035b35d.png"><img src="/assets/images/2009/05/clip_image0035b35d.png" alt="clip_image003" title="clip\_image003" /></a></li>
  <li>Select Create a new connection to: and Submit Data then click Next &gt;<a href="/assets/images/2009/05/clip_image0045b35d.png"><img src="/assets/images/2009/05/clip_image0045b35d.png" alt="clip_image004" title="clip\_image004" /></a></li>
  <li>On the next screen Select a destination for submitting your data choose the To a document library on a SharePoint site then choose next<a href="/assets/images/2009/05/clip_image0055b35d.png"><img src="/assets/images/2009/05/clip_image0055b35d.png" alt="clip_image005" title="clip\_image005" /></a></li>
  <li>Now provide a URL to the document library you want to submit your data to. In the next to the file name textbox click on the fx button. Click on the Insert Field or Group… button and select the submitFormName field.<a href="/assets/images/2009/05/clip_image0065b35d.png"><img src="/assets/images/2009/05/clip_image0065b35d.png" alt="clip_image006" title="clip\_image006" /></a></li>
  <li>Click the OK button on the Select a Field or Group window and on the Insert Formula Window. On the data connection wizard check the Allow overwrite if file exists option. Click Next &gt;.<a href="/assets/images/2009/05/clip_image0075b35d.png"><img src="/assets/images/2009/05/clip_image0075b35d.png" alt="clip_image007" title="clip\_image007" /></a></li>
  <li>You can now provide a custom name for your data connection then click Next &gt;.</li>
  <li>Click Close on the Data Connections windowAdd the actions to the Custom Button</li>
  <li>Double Click on the button control added to the InfoPath form<a href="/assets/images/2009/05/clip_image0085b35d.png"><img src="/assets/images/2009/05/clip_image0085b35d.png" alt="clip_image008" title="clip\_image008" /></a></li>
</ul>

<p>Select Rules and Custom Code for the Action and provide a label and control ID, if desired, of your choice.</p>

<p>Click on the Rules… button and then click on the Add button in the Rules Window.</p>

<p><a href="/assets/images/2009/05/clip_image0095b35d.png"><img src="/assets/images/2009/05/clip_image0095b35d.png" alt="clip_image009" title="clip\_image009" /></a></p>

<p>Screen clipping taken: 4/29/2009, 4:59 PM</p>

<p>Name this rule Set File Name and click on the Set Condition… button. For the Condition check if the submitFormName is blank. Click the OK button.</p>

<p><a href="/assets/images/2009/05/clip_image0105b35d.png"><img src="/assets/images/2009/05/clip_image0105b35d.png" alt="clip_image010" title="clip\_image010" /></a></p>

<p>Click the Add Action… button. For the action select Set a field’s value, for the Field select submitFormName, for the Value use, using the fx builder use the expression concat(“Account Request - “, now()) then click OK.</p>

<p><a href="/assets/images/2009/05/clip_image0115b35d.png"><img src="/assets/images/2009/05/clip_image0115b35d.png" alt="clip_image011" title="clip\_image011" /></a></p>

<p>Click OK on the Rule Window. Now click on the Add… button again on the Rules window. Name this rule Submit Form and do not specify a condition. Add an action to Submit using a data connection and select the Data connection created in the last section.</p>

<p><a href="/assets/images/2009/05/clip_image0125b35d.png"><img src="/assets/images/2009/05/clip_image0125b35d.png" alt="clip_image012" title="clip\_image012" /></a></p>

<p>Click the OK button on the Action and Rule windows.</p>

<p>Click the Add… button on the Rule Window. Name this rule Close Form and do not specify a condition. Add an action to close the form.</p>

<p><a href="/assets/images/2009/05/clip_image0135b35d.png"><img src="/assets/images/2009/05/clip_image0135b35d.png" alt="clip_image013" title="clip\_image013" /></a></p>

<p>Click Ok on all of the windows until you are back to the InfoPath form designer.</p>

<p>Now publish your form to the SharePoint site library that was specified in the Data Connection section. Once the form is published go to that library and choose Settings-&gt;Form Library Settings</p>

<p><a href="/assets/images/2009/05/clip_image0145b35d.png"><img src="/assets/images/2009/05/clip_image0145b35d.png" alt="clip_image014" title="clip\_image014" /></a></p>

<p>Under the General Settings choose Advanced settings</p>

<p><a href="/assets/images/2009/05/clip_image0155b35d.png"><img src="/assets/images/2009/05/clip_image0155b35d.png&quot;clip\_image015&quot;" alt="clip_image015" /></a></p>

<p>In Advanced Settings under the Browser-enabled Documents choose Display as a Web page and then click OK</p>

<p><a href="/assets/images/2009/05/clip_image0165b35d.png"><img src="/assets/images/2009/05/clip_image0165b35d.png" alt="clip_image016" title="clip\_image016" /></a></p>

<p>This will force the InfoPath form to be opened using Form Services.</p>

<p>Now complete a form and submit it. Then click on the form, change a value and submit again. You should see your changes applied after you submit.</p>

</p>
    <p><a class="link-secondary" href="/2009/05/14/custom-save-button-for-web-enabled-form/">Read more...</a></p>
</article>

  </div>

</article>

    </main><script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>  
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script></body>
</html>