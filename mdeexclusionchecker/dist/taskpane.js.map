{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack:///webpack/bootstrap?","webpack:///webpack/runtime/define property getters?","webpack:///webpack/runtime/hasOwnProperty shorthand?","webpack:///./src/taskpane/taskpane.js?"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n * See LICENSE in the project root for license information.\r\n */\r\n\r\n/* global console, document, Excel, Office */\r\n\r\nconst exclusionListUrl = \"https://raw.githubusercontent.com/dmcwee/dmcwee.github.io/master/MDEExclusionChecker/exclusionList/mde-exclusions.json\";\r\n\r\nOffice.onReady((info) => {\r\n  if (info.host === Office.HostType.Excel) {\r\n    document.getElementById(\"sideload-msg\").style.display = \"none\";\r\n    document.getElementById(\"app-body\").style.display = \"flex\";\r\n    document.getElementById(\"run\").onclick = run;\r\n    document.getElementById(\"clearLog\").onclick = clearLog;\r\n  }\r\n});\r\n\r\nexport async function run() {\r\n  try {\r\n    await Excel.run(async (context) => {\r\n      /**\r\n       * Insert your Excel code here\r\n       */\r\n      log(\"Staring Analysis\");\r\n\r\n      var range = context.workbook.getSelectedRange();\r\n      range.load(\"address\");\r\n      range.load(\"values\");\r\n\r\n      log(\"Before Await\");\r\n      await context.sync();\r\n      log(`range values: ${JSON.stringify(range.values)}`);\r\n\r\n      //get the mde exclusions\r\n      log(`Calling ${exclusionListUrl}`);\r\n      let response = await fetch(\r\n        exclusionListUrl\r\n      );\r\n      if (response.ok) {\r\n        log(`Response was OK.`);\r\n        var json = await response.json();\r\n        log(`Response: ${JSON.stringify(json)}`);\r\n\r\n        var newRange = validateRange(range, json);\r\n\r\n        log(`newRange: ${JSON.stringify(newRange)}`);\r\n\r\n        range.values = newRange;\r\n        range.format.autofitColumns();\r\n\r\n        context.sync();\r\n\r\n        log(`DONE!`);\r\n        return;\r\n      } else {\r\n        log(\"There was a problem loading the list of Exclusion Paths\");\r\n      }\r\n    });\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n}\r\n\r\nexport function clearLog() {\r\n  document.getElementById(\"logMessages\").value = \"\";\r\n}\r\n\r\nfunction log(message) {\r\n  console.log(`Log: ${message}`);\r\n  document.getElementById(\"logMessages\").value += `${message}\\n`;\r\n}\r\n\r\nfunction validateRange(range, defaultList) {\r\n  var validatedRange = [];\r\n  for (let i = 0; i < range.values.length; ++i) {\r\n    let exclusion = range.values[i];\r\n    validatedRange.push(compareExclusionToDefaultList(exclusion[0], defaultList));\r\n    log(`validated range after push is now ${JSON.stringify(validatedRange)}`);\r\n  }\r\n  return validatedRange;\r\n}\r\n\r\nfunction compareExclusionToDefaultList(exclusion, defaultList) {\r\n  for (let i = 0; i < defaultList.length; ++i) {\r\n    let defaultRule = defaultList[i];\r\n    log(`Comparing ${JSON.stringify(exclusion)} agaist ${JSON.stringify(defaultRule.name)}:${JSON.stringify(defaultRule.paths)}`);\r\n    if (compareExclusionToDefaultPaths(exclusion, defaultRule.paths)) {\r\n      log(` + Match.  Returning ${JSON.stringify([exclusion, JSON.stringify(defaultRule.paths), defaultRule.name])}`);\r\n      return [exclusion, defaultRule.name];\r\n    } else {\r\n      log(` - Match`);\r\n    }\r\n  }\r\n  return [exclusion, \"No Matches\"];\r\n}\r\n\r\nfunction compareExclusionToDefaultPaths(exclusion, defaultPaths) {\r\n  for (let i = 0; i < defaultPaths.length; ++i) {\r\n    let defaultPath = defaultPaths[i];\r\n    log(`Comparing ${JSON.stringify(exclusion)} against path ${JSON.stringify(defaultPath)}`);\r\n    let result = checkMatch(exclusion, defaultPath);\r\n    if (result) {\r\n      log(`compareExclusionToDefaultPath returning true after match with ${defaultPath}`);\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction checkMatch(exclusion, defaultPathRegex) {\r\n  var regex = new RegExp(defaultPathRegex, \"ig\");\r\n  let result = regex.test(exclusion);\r\n  let match = exclusion.match(regex);\r\n\r\n  //log(`RegEx.toString(): ${regex.toString()} - ${exclusion.match(regex)} or ${regex.test(exclusion)}`);\r\n  \r\n  log(`checkMatch returning ${result} and match ${match}`);\r\n  //return regex.test(exclusion);\r\n  return result;\r\n}\r\n"],"names":["__webpack_require__","d","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","exclusionListUrl","run","Excel","context","log","range","workbook","getSelectedRange","load","sync","JSON","stringify","values","fetch","response","ok","json","newRange","validateRange","format","autofitColumns","console","error","clearLog","document","getElementById","value","message","defaultList","validatedRange","i","length","exclusion","push","compareExclusionToDefaultList","defaultRule","name","paths","compareExclusionToDefaultPaths","defaultPaths","defaultPath","checkMatch","defaultPathRegex","regex","RegExp","result","test","match","Office","onReady","info","host","HostType","style","display","onclick"],"sourceRoot":""}